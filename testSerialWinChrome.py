

#
# This code was written 2024-12-26 based on code generated by Gemini
# As of 2024-12-28 code was working on a windows computer and a Chromebook
# computer.
#

import os
import serial

# Declare an exception if the port does not exists.

class PortDoesNotExist(Exception):
    pass

def port_exists(file_path):
  """Checks if a file exists at the given path.

  Args:
    file_path: The path to the file.

  Returns:
    True if the file exists, False otherwise.
  """
  return os.path.exists(file_path)

if __name__ == '__main__':

    # 'nt' indicates a windows computer
    
    if os.name == 'nt':
        port = 'COM6'
    else:
        port = '/dev/ttyUSB0'

    try:
        if (port_exists(port)):
            print (f'Open the serial port, with port {port}')
            ser = serial.Serial(port, 9600)
        else:
            print ('Port does not exist')
            raise PortDoesNotExist()
    
        print (f"Serial info: {ser}")
        print (f"Print the current timeout and then set it for 2.0")
        print (f"Serial timeout: {ser.timeout}")
        ser.timeout = 2.0
        print (f"Connectd to port: {port}")
        print (f"Serial timeout: {ser.timeout}")
        # serial read/write code codes here
    
        input = ser.read (1)

        print (f"Serial read has timed out")
    
    except serial.SerialException as e:
        print (f"Error connecting to serial port: {e}")

    except PortDoesNotExist:
        print ('Exception, port does not exist occurred')
        
    finally:
        print ('About to try and close the serial port')
        try:
            ser.close()
            print ('Serial port has been closed')
        except:
            print ('Exit as ser is not defined so no need to close')
            

    






